name: GÃ©nÃ©rer Factures PDF depuis Notion

on:
  workflow_dispatch:  # Permet l'exÃ©cution manuelle dans GitHub

jobs:
  generate-factures:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ Cloner le repo
        uses: actions/checkout@v3

      - name: ðŸ Configurer Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: ðŸ“¦ Installer les dÃ©pendances
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: ðŸ” Charger les variables dâ€™environnement
        env:
          NOTION_API_KEY: ${{ secrets.NOTION_API_KEY }}
          DATABASE_FACTURES_ID: ${{ secrets.DATABASE_FACTURES_ID }}
          DATABASE_LIGNES_ID: ${{ secrets.DATABASE_LIGNES_ID }}
        run: |
          echo "NOTION_API_KEY=${NOTION_API_KEY}" >> .env
          echo "DATABASE_FACTURES_ID=${DATABASE_FACTURES_ID}" >> .env
          echo "DATABASE_LIGNES_ID=${DATABASE_LIGNES_ID}" >> .env

      - name: ðŸš€ Lancer le script Python
        run: python main.py
